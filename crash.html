<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Combined Stress Test</title>
</head>
<body>
  <h1>Combined Stress Test (Memory, Infinite Loop, Recursion)</h1>
  <script>
    window.onload = () => {
      // Part 1: Memory exhaustion (allocating a large array with caution)
      const largeArray = [];
      console.log("Starting memory allocation...");
      let memoryTestCount = 0;

      function allocateMemory() {
        if (memoryTestCount < 8000) { // Control the memory allocation size
          largeArray.push(new Array(1000)); // Allocate smaller chunks
          memoryTestCount++;
        } else {
          console.log("Memory allocation finished.");
        }
      }

      allocateMemory();

      // Part 2: Infinite loop (CPU exhaustion with limited impact)
      console.log("Starting CPU stress (controlled infinite loop)...");
      let cpuTestInterval;
      function startInfiniteLoop() {
        cpuTestInterval = setInterval(() => {
          // This loop will run indefinitely but in intervals, preventing UI freeze
          Math.random(); // Just a dummy operation to keep the loop running
        }, 0);
      }

      startInfiniteLoop();

      // Part 3: Recursion (controlled stack overflow)
      console.log("Starting recursion...");
      let recursionDepth = 0;

      function recurse() {
        if (recursionDepth < 1000) { // Limit recursion depth to avoid stack overflow
          recursionDepth++;
          recurse();
        } else {
          console.log("Recursion reached safe depth.");
        }
      }

      recurse();
    };
  </script>
</body>
</html>
